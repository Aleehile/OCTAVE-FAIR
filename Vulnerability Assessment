import boto3
import time

# Initialize the AWS Inspector client
inspector = boto3.client('inspector')

# Define the target resource for assessment
target_arn = 'arn:aws:inspector:us-east-1:123456789012:target/0-n1xmliu0'

# Define the assessment template for scanning
assessment_template_arn = 'arn:aws:inspector:us-east-1:123456789012:target/0-n1xmliu0/template/0-n1xmliu0'

def start_assessment_run():
    response = inspector.start_assessment_run(
        assessmentTemplateArn=assessment_template_arn,
        assessmentRunName='MyAssessmentRun'
    )
    return response['assessmentRunArn']

def get_assessment_run_status(assessment_run_arn):
    response = inspector.describe_assessment_runs(
        assessmentRunArns=[assessment_run_arn]
    )
    return response['assessmentRuns'][0]['state']

if __name__ == '__main__':
    assessment_run_arn = start_assessment_run()
    print("Assessment run started:", assessment_run_arn)

    while True:
        status = get_assessment_run_status(assessment_run_arn)
        print("Assessment run status:", status)
        
        if status == 'COMPLETED':
            print("Assessment run completed.")
            break
        elif status in ['CANCELED', 'FAILED']:
            print("Assessment run failed or was canceled.")
            break
        
        time.sleep(60)  # Check status every minute
